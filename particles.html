<!DOCTYPE html>
<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.3.10/pixi.min.js"></script>
</head>
<body>
    <script>
        const app = new PIXI.Application({
            width: window.innerWidth,
            height: window.innerHeight,
            //white background
            backgroundColor: 0xffffff,
            resolution: window.devicePixelRatio || 1,
        });

        document.body.appendChild(app.view);

        const spriteContainer = new PIXI.Container();
        app.stage.addChild(spriteContainer);

        const imagePaths = ['lego-bricks/blue_rect.png', 'lego-bricks/green_circle.png', 'lego-bricks/violet_moon.png', 'lego-bricks/yellow_brick.png'];
        PIXI.Loader.shared.add(imagePaths).load((loader, resources) => {
            const sprites = [];
            for (let i = 0; i < 200; i++) {
                const textureIndex = Math.floor(Math.random() * imagePaths.length);
                const sprite = new PIXI.Sprite(resources[imagePaths[textureIndex]].texture);
                sprite.x = Math.random() * app.renderer.screen.width;
                sprite.y = Math.random() * app.renderer.screen.height;
                sprite.anchor.set(0.5);
                //Randomly scaling the bricks
                const scale = Math.random() * 0.5 + 0.5; 
                sprite.scale.set(0.25*scale);
                //velocity
                sprite.vx = (Math.random() - 0.5) * 2; 
                sprite.vy = (Math.random() - 0.5) * 2;
                //target opacity
                sprite.currentAlpha = Math.random();
                sprite.targetAlpha = sprite.currentAlpha; 
                sprites.push(sprite);
                spriteContainer.addChild(sprite);
            }

            function update() {
                sprites.forEach(sprite => {
                    const maxChange = 0.08; 
                    // Update position
                    sprite.x += sprite.vx;
                    sprite.y += sprite.vy;

                    if (sprite.x > app.renderer.screen.width) {
                        sprite.x = 0;
                    }
                    if (sprite.x < 0) {
                        sprite.x = app.renderer.screen.width;
                    }
                    if (sprite.y > app.renderer.screen.height) {
                        sprite.y = 0;
                    }
                    if (sprite.y < 0) {
                        sprite.y = app.renderer.screen.height;
                    }

                    const alphaChangeSpeed = 0.1; //opacity speed transition
                    sprite.currentAlpha += (sprite.targetAlpha - 0.8*sprite.currentAlpha) * alphaChangeSpeed;
                    sprite.alpha = 0.8*sprite.currentAlpha;
                    //Randomly change opacity
                    if (Math.random() < 0.01) { 
                        sprite.targetAlpha = Math.random(); 
                    }
                });
                
            }

            app.ticker.add(update);
        });
    </script>
</body>
</html>
